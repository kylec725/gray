syntax = "proto3";

package graytorrent;

option go_package = "github.com/kylec725/graytorrent/rpc";

service TorrentService {
  // Requests a list of all managed torrents
  rpc List (Empty) returns (ListReply) {}
  // Adds another torrent to be managed
  rpc Add (AddRequest) returns (TorrentReply) {}
  // Removes a torrent from being managed
  rpc Remove (RemoveRequest) returns (TorrentReply) {}
  // Starts a torrent's download/upload
  rpc Start (TorrentRequest) returns (TorrentReply) {}
  // Stops a torrent's download/upload
  rpc Stop (TorrentRequest) returns (TorrentReply) {}
}

message Empty {
}

message Torrent {
  uint32 id = 1;
  string name = 2;
  bytes infoHash = 3;
  uint32 totalLength = 4;
  uint32 left = 5;
  uint32 downRate = 6;
  uint32 upRate = 7;
  enum State {
    DOWNLOADING = 0;
    STOPPED = 1;
    STALLED = 2;
    SEEDING = 3;
    COMPLETE = 4;
  }
  State state = 8;
}

message ListReply {
  repeated Torrent torrentList = 1;
}

message TorrentRequest {
  uint32 id = 1;
  bytes infoHash = 2;
}

message TorrentReply {
  uint32 id = 1;
  string name = 2;
  bytes infoHash = 3;
}

message AddRequest {
  string name = 1;
  bool magnet = 2;
  string directory = 3;
}

message RemoveRequest {
  TorrentRequest torrentRequest = 1;
  bool rmFiles = 2;
}
